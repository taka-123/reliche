{
  "cleanupPeriodDays": 30,
  "env": {
    "CLAUDE_CODE_ENABLE_TELEMETRY": "0",
    "DISABLE_TELEMETRY": "1"
  },
  "includeCoAuthoredBy": false,
  "permissions": {
    "allow": [
      "Read(README*)",
      "Read(package.json)",
      "Read(pyproject.toml)",
      "Read(Cargo.toml)",
      "Read(go.mod)",
      "Read(.gitignore)",
      "Read(LICENSE*)",
      "Read(CHANGELOG*)",
      "Bash(git status)",
      "Bash(git log --oneline -10)",
      "Bash(git diff)",
      "Bash(git branch)",
      "Bash(ls)",
      "Bash(pwd)",
      "Bash(whoami)",
      "Bash(which git)",
      "Bash(which php)",
      "Bash(which node)",
      "Bash(which npm)",
      "Bash(cat package.json)",
      "Bash(cat pyproject.toml)",
      "Bash(cat Cargo.toml)",
      "Bash(cat go.mod)",
      "Bash(cat **/package-lock.json)",
      "Bash(cat composer.json)",
      "Bash(cat composer.lock)",
      "WebFetch(domain:docs.anthropic.com)",
      "WebFetch(domain:github.com/*/releases)",
      "WebFetch(domain:pypi.org/project/*)",
      "WebFetch(domain:npmjs.com/package/*)",
      "WebFetch(domain:laravel.com/docs/*)",
      "WebFetch(domain:vuejs.org/guide/*)",
      "WebFetch(domain:developer.mozilla.org/*)"
    ],
    "deny": [
      // === 秘密情報・認証関連 ===
      "Read(**/.env*)",
      "Write(**/.env*)",
      "Edit(**/.env*)",
      "Read(id_rsa)",
      "Read(id_ed25519)",
      "Read(**/*key*)",
      "Read(**/*token*)",
      "Read(~/.ssh/*)",
      "Write(~/.ssh/*)",
      "Read(~/.aws/*)",
      "Write(~/.aws/*)",
      "Read(~/.gcp/*)",
      "Write(~/.gcp/*)",
      "Read(**/config/database*)",
      "Write(**/config/database*)",
      "Read(.npmrc)",
      "Write(.npmrc)",
      "Read(.pypirc)",
      "Write(.pypirc)",

      // === 危険なシステム操作 ===
      "Bash(rm -rf*)",
      "Bash(sudo:*)",
      "Bash(nc:*)",
      "Bash(mkfs:*)",
      "Bash(dd:*)",
      "Bash(killall*)",
      "Bash(pkill*)",
      "Bash(systemctl*)",
      "Bash(service*)",
      "Bash(crontab*)",
      "Bash(chmod 777*)",
      "Bash(chown*)",
      "Bash(find * -delete*)",
      "Bash(find / *)",
      "Bash(grep -r *password* *)",
      "Bash(grep -r *secret* *)",
      "Bash(cat /etc/passwd)",
      "Bash(cat /etc/shadow)",
      "Bash(env)",
      "Bash(printenv)",
      "Bash(set | grep *)",

      // === データベース直接操作 ===
      "Bash(psql:*)",
      "Bash(mysql:*)",
      "Bash(mongod:*)",
      "Bash(*DROP*)",
      "Bash(*DELETE FROM*)",
      "Bash(*TRUNCATE*)",
      "Bash(*ALTER TABLE*DROP*)",
      "mcp__supabase__execute_sql",

      // === Laravel/PHP 危険コマンド ===
      "Bash(php artisan tinker*)",
      "Bash(php artisan db*)",
      "Bash(php artisan seed*)",
      "Bash(php artisan key:generate*)",
      "Bash(php artisan config:cache*)",
      "Bash(php artisan config:clear*)",
      "Bash(php artisan cache:clear*)",
      "Bash(php artisan optimize*)",
      "Bash(php artisan down*)",
      "Bash(php artisan up*)",
      "Bash(php artisan queue:work*)",
      "Bash(php artisan queue:listen*)",
      "Bash(php artisan queue:*)",
      "Bash(php artisan migrate:fresh*)",
      "Bash(php artisan migrate:reset*)",
      "Bash(php artisan storage:link*)",

      // === パッケージ管理 ===
      "Bash(composer remove*)",
      "Bash(composer update*)",
      "Bash(composer install --no-dev*)",
      "Bash(npm uninstall*)",
      "Bash(npm remove*)",
      "Bash(npm update*)",
      "Bash(npm run build*)",
      "Bash(npm run production*)",
      "Bash(yarn add*)",
      "Bash(yarn remove*)",
      "Bash(yarn install*)",

      // === Git 危険操作 ===
      "Bash(git push origin main*)",
      "Bash(git push origin master*)",
      "Bash(git push --force*)",
      "Bash(git push -f*)",
      "Bash(git reset --hard*)",
      "Bash(git rebase*)",

      // === GitHub CLI 危険操作 ===
      "Bash(gh auth*)",
      "Bash(gh release create*)",
      "Bash(gh repo delete*)",
      "Bash(gh secret set*)",
      "Bash(gh variable set*)",

      // === Docker 危険操作 ===
      "Bash(docker system prune*)",
      "Bash(docker volume rm*)",
      "Bash(docker exec *)",
      "Bash(docker run --privileged*)",
      "Bash(docker run -v /:/host*)",

      // === クラウド・インフラ ===
      "Bash(aws cloudformation delete-stack)",
      "Bash(aws s3 rm*)",
      "Bash(aws s3api delete*)",
      "Bash(aws ec2 terminate-instances*)",
      "Bash(aws rds delete-db-instance*)",
      "Bash(aws rds delete-db-cluster*)",
      "Bash(aws iam delete*)",
      "Bash(aws lambda delete-function*)",
      "Bash(aws dynamodb delete-table*)",
      "Bash(aws route53 delete*)",
      "Bash(aws logs delete*)",
      "Bash(aws secretsmanager delete-secret*)",
      "Bash(aws elasticache delete*)",
      "Bash(aws elbv2 delete*)",
      "Bash(aws autoscaling delete*)",
      "Bash(gcloud compute instances delete*)",
      "Bash(gcloud sql instances delete*)",
      "Bash(gcloud container clusters delete*)",
      "Bash(gcloud projects delete*)",
      "Bash(az vm delete*)",
      "Bash(az group delete*)",
      "Bash(az sql server delete*)",
      "Bash(fly apps destroy*)",
      "Bash(fly volumes destroy*)",
      "Bash(fly postgres detach*)",
      "Bash(fly secrets unset*)",
      "Bash(fly scale count 0*)",
      "Bash(fly deploy --strategy immediate*)",
      "List(*)",

      // === ネットワーク・外部通信 ===
      "Bash(wget*)",
      "Bash(curl -X POST*)",
      "Bash(curl -X PUT*)",
      "Bash(curl -X DELETE*)",
      "Bash(ssh*)",
      "Bash(scp*)",
      "Bash(netstat *)",
      "Bash(nmap *)",
      "Bash(ifconfig)",
      "Bash(ip a)",
      "WebFetch(*auth*)",
      "WebFetch(*login*)",
      "WebFetch(*password*)",
      "WebFetch(*secret*)",
      "WebFetch(*token*)",
      "WebFetch(*admin*)",
      "WebFetch(*api/v*/auth*)",

      // === パイプ・リダイレクトによるコマンド回避防止 ===
      // コマンド実行ラッパーの制限
      "Bash(eval*)",
      "Bash(source*)",
      "Bash(xargs*)",
      "Bash(bash -c*)",
      "Bash(sh -c*)",
      // パイプを使った危険なコマンド回避の防止
      "Bash(*| php artisan*)",
      "Bash(*| mysql*)",
      "Bash(*| psql*)",
      "Bash(*| rm*)",
      "Bash(*| sudo*)",
      "Bash(*| chmod*)",
      "Bash(*| chown*)",
      "Bash(*| curl*)",
      "Bash(*| wget*)",
      // 危険なリダイレクト
      "Bash(*> /etc/*)",
      "Bash(*>> /etc/*)",
      "Bash(*> ~/.ssh/*)",
      "Bash(*>> ~/.ssh/*)",
      "Bash(*> */.env*)",
      "Bash(*>> */.env*)"
    ]
  }
}
